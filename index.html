<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Untitled</title>
  

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日時選択ウィジェット</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Meiryo', sans-serif;
            background-color: #f8f9fa;
        }
        .calendar-container {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #f5f7ff 0%, #ffffff 100%);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        }
        .gradient-hover {
            transition: all 0.3s ease;
        }
        .gradient-hover:hover {
            background: linear-gradient(135deg, #5a5fec 0%, #7c4deb 100%);
            transform: translateY(-2px);
        }
        input[type="date"], select {
            cursor: pointer;
        }
        .result-text {
            transition: all 0.3s ease;
        }
        .date-item {
            animation: fadeIn 0.4s ease-in-out;
            transition: all 0.3s ease;
        }
        .date-item:hover {
            transform: translateX(2px);
            border-color: #8b5cf6;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .date-item-remove {
            animation: fadeOut 0.3s ease-in-out;
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(10px); }
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(139, 92, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); }
        }
    </style>
</head>
<body>
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="calendar-container rounded-xl p-6 w-full max-w-4xl">
            <div class="flex flex-col md:flex-row gap-6">
                <!-- 左側：入力エリア -->
                <div class="w-full md:w-1/2 space-y-4">
                    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm">
                        <div class="grid grid-cols-1 gap-4">
                            <!-- 日付選択 -->
                            <div>
                                <label for="date-picker" class="block text-sm font-medium text-gray-700 mb-1">日付</label>
                                <input 
                                    type="date" 
                                    id="date-picker" 
                                    class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white text-gray-800"
                                >
                            </div>
                            
                            <!-- 時間選択（開始・終了） -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label for="start-time" class="block text-sm font-medium text-gray-700 mb-1">開始時刻</label>
                                    <select 
                                        id="start-time" 
                                        class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white text-gray-800"
                                    >
                                        <!-- 時間オプションはJSで生成 -->
                                    </select>
                                </div>
                                <div>
                                    <label for="end-time" class="block text-sm font-medium text-gray-700 mb-1">終了時刻</label>
                                    <select 
                                        id="end-time" 
                                        class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white text-gray-800"
                                    >
                                        <!-- 時間オプションはJSで生成 -->
                                    </select>
                                </div>
                            </div>
                            
                            <!-- 追加ボタン -->
                            <button 
                                id="add-btn"
                                class="w-full gradient-bg gradient-hover text-white font-medium py-2.5 px-4 rounded-lg transition duration-300 ease-in-out shadow-md"
                            >
                                日時を追加
                            </button>
                        </div>
                    </div>
                    
                    <!-- フォーマット選択 -->
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
                        <div class="flex flex-wrap gap-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="format" value="standard" class="form-radio text-indigo-600" checked>
                                <span class="ml-2 text-gray-700">通常表示</span>
                                <span class="ml-1 text-xs text-gray-500">(5月1日(月) 13:30〜15:00)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="format" value="long" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">詳細表示</span>
                                <span class="ml-1 text-xs text-gray-500">(5月1日(月曜日) 13時30分〜15時00分)</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="format" value="short" class="form-radio text-indigo-600">
                                <span class="ml-2 text-gray-700">簡易表示</span>
                                <span class="ml-1 text-xs text-gray-500">(5/1 13:30〜15:00)</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- 右側：結果エリア -->
                <div class="w-full md:w-1/2 space-y-4">
                    <!-- 選択された日時のリスト -->
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
                        <div class="flex justify-between items-center mb-3">
                            <h2 class="text-base font-semibold text-gray-700">選択された日時</h2>
                            <button 
                                id="clear-btn"
                                class="text-sm bg-gray-100 hover:bg-gray-200 text-gray-600 font-medium py-1 px-3 rounded-md transition duration-300 ease-in-out"
                            >
                                すべてクリア
                            </button>
                        </div>
                        <div id="date-list" class="space-y-2 max-h-40 overflow-y-auto">
                            <!-- ここに選択された日時が追加されます -->
                        </div>
                    </div>
                    
                    <!-- 結果表示エリア -->
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
                        <h2 class="text-base font-semibold text-gray-700 mb-2">テキスト出力</h2>
                        <textarea 
                            id="result" 
                            class="result-text w-full h-40 p-3 text-gray-800 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"
                            readonly
                        >選択された日時がここに表示されます</textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 時間選択肢を生成（15分単位）
            function populateTimeOptions(selectElement) {
                for (let hour = 0; hour < 24; hour++) {
                    for (let minute of [0, 15, 30, 45]) {
                        const hourStr = String(hour).padStart(2, '0');
                        const minuteStr = String(minute).padStart(2, '0');
                        const timeValue = `${hourStr}:${minuteStr}`;
                        const timeDisplay = `${hour}:${minuteStr}`;
                        
                        const option = document.createElement('option');
                        option.value = timeValue;
                        option.textContent = timeDisplay;
                        selectElement.appendChild(option);
                    }
                }
            }
            
            const startTimeSelect = document.getElementById('start-time');
            const endTimeSelect = document.getElementById('end-time');
            
            populateTimeOptions(startTimeSelect);
            populateTimeOptions(endTimeSelect);
            
            // 今日の日付をデフォルトにする
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            document.getElementById('date-picker').value = `${yyyy}-${mm}-${dd}`;
            
            // 現在時刻に最も近い15分単位の時間をデフォルトに設定
            const currentHour = today.getHours();
            const currentMinute = today.getMinutes();
            const roundedMinute = Math.floor(currentMinute / 15) * 15;
            const defaultStartTime = `${String(currentHour).padStart(2, '0')}:${String(roundedMinute).padStart(2, '0')}`;
            
            // 終了時間は開始時間の1時間後をデフォルトに
            let endHour = currentHour + 1;
            if (endHour >= 24) endHour = 23;
            const defaultEndTime = `${String(endHour).padStart(2, '0')}:${String(roundedMinute).padStart(2, '0')}`;
            
            startTimeSelect.value = defaultStartTime;
            endTimeSelect.value = defaultEndTime;
            
            // 開始時間が変更されたら、終了時間も自動調整
            startTimeSelect.addEventListener('change', function() {
                const startTime = this.value;
                const [startHour, startMinute] = startTime.split(':').map(Number);
                
                const endTime = endTimeSelect.value;
                const [endHour, endMinute] = endTime.split(':').map(Number);
                
                // 終了時間が開始時間より前なら、開始時間の1時間後に設定
                if (endHour < startHour || (endHour === startHour && endMinute <= startMinute)) {
                    let newEndHour = startHour + 1;
                    if (newEndHour >= 24) newEndHour = 23;
                    endTimeSelect.value = `${String(newEndHour).padStart(2, '0')}:${String(startMinute).padStart(2, '0')}`;
                }
            });
            
            // 選択された日時を保存する配列
            let selectedDates = [];
            
            // 追加ボタンのクリックイベント
            document.getElementById('add-btn').addEventListener('click', addDateTime);
            
            // クリアボタンのクリックイベント
            document.getElementById('clear-btn').addEventListener('click', clearAllDates);
            
            // ラジオボタンが変更されたときに表示を更新
            const radioButtons = document.querySelectorAll('input[name="format"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', updateResult);
            });
            
            function addDateTime() {
                const datePicker = document.getElementById('date-picker');
                const startTime = document.getElementById('start-time').value;
                const endTime = document.getElementById('end-time').value;
                
                // 日付が選択されているか確認
                if (!datePicker.value) {
                    alert('日付を選択してください');
                    return;
                }
                
                // 開始時間と終了時間の妥当性チェック
                const [startHour, startMinute] = startTime.split(':').map(Number);
                const [endHour, endMinute] = endTime.split(':').map(Number);
                
                if (endHour < startHour || (endHour === startHour && endMinute <= startMinute)) {
                    alert('終了時刻は開始時刻より後にしてください');
                    return;
                }
                
                // 選択された日付と時間を取得
                const startDate = new Date(`${datePicker.value}T${startTime}`);
                const endDate = new Date(`${datePicker.value}T${endTime}`);
                
                // 日時の組み合わせを作成
                const dateTimeCombo = {
                    start: startDate,
                    end: endDate
                };
                
                // 重複チェック
                const isDuplicate = selectedDates.some(item => 
                    item.start.getTime() === dateTimeCombo.start.getTime() && 
                    item.end.getTime() === dateTimeCombo.end.getTime()
                );
                
                if (isDuplicate) {
                    alert('この日時は既に追加されています');
                    return;
                }
                
                // 配列に追加
                selectedDates.push(dateTimeCombo);
                
                // 日付をソート（古い順）
                selectedDates.sort((a, b) => a.start - b.start);
                
                // リストを更新
                updateDateList();
                
                // 結果を更新
                updateResult();
                
                // 追加ボタンにアニメーション効果
                const addBtn = document.getElementById('add-btn');
                addBtn.classList.add('pulse-animation');
                setTimeout(() => {
                    addBtn.classList.remove('pulse-animation');
                }, 2000);
            }
            
            function formatDateTime(dateTimeCombo, formatType) {
                const startDate = dateTimeCombo.start;
                const endDate = dateTimeCombo.end;
                
                // 日本語の曜日
                const weekdays = ['日', '月', '火', '水', '木', '金', '土'];
                const weekdayLong = ['日曜日', '月曜日', '火曜日', '水曜日', '木曜日', '金曜日', '土曜日'];
                
                // 月と日を取得
                const month = startDate.getMonth() + 1;
                const day = startDate.getDate();
                const weekday = startDate.getDay();
                
                // 開始時間と分を取得
                const startHours = startDate.getHours();
                const startMinutes = String(startDate.getMinutes()).padStart(2, '0');
                
                // 終了時間と分を取得
                const endHours = endDate.getHours();
                const endMinutes = String(endDate.getMinutes()).padStart(2, '0');
                
                switch (formatType) {
                    case 'long':
                        return `${month}月${day}日（${weekdayLong[weekday]}） ${startHours}時${startMinutes}分〜${endHours}時${endMinutes}分`;
                    case 'short':
                        return `${month}/${day} ${startHours}:${startMinutes}〜${endHours}:${endMinutes}`;
                    default: // standard
                        return `${month}月${day}日（${weekdays[weekday]}） ${startHours}:${startMinutes}〜${endHours}:${endMinutes}`;
                }
            }
            
            function updateDateList() {
                const dateList = document.getElementById('date-list');
                dateList.innerHTML = '';
                
                if (selectedDates.length === 0) {
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'text-gray-500 text-sm italic text-center py-2';
                    emptyMessage.textContent = '日時が選択されていません';
                    dateList.appendChild(emptyMessage);
                    return;
                }
                
                const formatType = document.querySelector('input[name="format"]:checked').value;
                
                selectedDates.forEach((dateTimeCombo, index) => {
                    const dateItem = document.createElement('div');
                    dateItem.className = 'date-item flex justify-between items-center p-2.5 bg-gray-50 rounded-lg border border-gray-200';
                    dateItem.dataset.index = index;
                    
                    const dateText = document.createElement('span');
                    dateText.className = 'text-sm';
                    dateText.textContent = formatDateTime(dateTimeCombo, formatType);
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'text-red-500 hover:text-red-700 focus:outline-none';
                    removeBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>';
                    removeBtn.addEventListener('click', function() {
                        removeDateItem(index, dateItem);
                    });
                    
                    dateItem.appendChild(dateText);
                    dateItem.appendChild(removeBtn);
                    dateList.appendChild(dateItem);
                });
            }
            
            function removeDateItem(index, element) {
                // アニメーション効果を追加
                element.classList.add('date-item-remove');
                
                setTimeout(() => {
                    // 配列から削除
                    selectedDates.splice(index, 1);
                    
                    // リストを更新
                    updateDateList();
                    
                    // 結果を更新
                    updateResult();
                }, 300);
            }
            
            function updateResult() {
                const result = document.getElementById('result');
                const formatType = document.querySelector('input[name="format"]:checked').value;
                
                if (selectedDates.length === 0) {
                    result.value = '選択された日時がここに表示されます';
                    return;
                }
                
                // 選択された日時を整形して結合
                const formattedDates = selectedDates.map(dateTimeCombo => 
                    formatDateTime(dateTimeCombo, formatType)
                );
                
                result.value = formattedDates.join('\n');
                
                // テキストエリアにアニメーション効果
                result.style.opacity = '0.7';
                setTimeout(() => {
                    result.style.opacity = '1';
                }, 150);
            }
            
            function clearAllDates() {
                if (selectedDates.length === 0) return;
                
                if (confirm('すべての日時をクリアしますか？')) {
                    selectedDates = [];
                    updateDateList();
                    updateResult();
                }
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93e1bae672bdd5cf',t:'MTc0Njk2NzA3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
<!-- partial -->
  
</body>
</html>
